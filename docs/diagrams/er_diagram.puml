@startuml er_diagram
!define primary_key(x) <b><color:red>*</color> x</b>
!define foreign_key(x) <color:blue>^</color> x

entity Book {
  primary_key(book_id): INTEGER
  --
  title: TEXT
  author: TEXT
  isbn: TEXT
  year: INTEGER
  publisher: TEXT
  category: TEXT
}

entity Copy {
  primary_key(copy_id): INTEGER
  foreign_key(book_id): INTEGER
  --
  barcode: TEXT
  status: TEXT
  condition: TEXT
}

entity Reader {
  primary_key(reader_id): INTEGER
  --
  name: TEXT
  card_number: TEXT
  contact: TEXT
  status: TEXT
}

entity Loan {
  primary_key(loan_id): INTEGER
  foreign_key(copy_id): INTEGER
  foreign_key(reader_id): INTEGER
  --
  issue_date: TEXT
  due_date: TEXT
  return_date: TEXT
  status: TEXT
}

entity Reservation {
  primary_key(reservation_id): INTEGER
  foreign_key(book_id): INTEGER
  foreign_key(reader_id): INTEGER
  --
  reservation_date: TEXT
  status: TEXT
}

entity Fine {
  primary_key(fine_id): INTEGER
  foreign_key(reader_id): INTEGER
  --
  amount: REAL
  reason: TEXT
  status: TEXT
}

Book ||--o{ Copy : "has"
Copy ||--o{ Loan : "borrowed_in"
Reader ||--o{ Loan : "borrows"
Reader ||--o{ Reservation : "makes"
Book ||--o{ Reservation : "reserved_in"
Reader ||--o{ Fine : "has"

@enduml